(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{10:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(22);var o=a(n(9)),i=a(n(5));function a(e){return e&&e.__esModule?e:{default:e}}var l=function(t){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.state={tree:{},reload:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e.Component),r(n,[{key:"handleChange",value:function(e){this.setState({tree:e})}},{key:"handleTreeReload",value:function(){var e=this.state.reload;this.setState({reload:!e})}},{key:"render",value:function(){var t=this.handleTreeReload,n=this.handleChange,r=this.state,a=r.tree,l=r.reload;return e.createElement("div",{className:"home"},e.createElement(o.default,{src:"https://juejin.im/timeline",onChange:n.bind(this),reload:l}),e.createElement(i.default,{onTreeReload:t.bind(this),tree:a}))}}]),n}();t.default=l}).call(this,n(0))},20:function(e,t,n){"use strict";(function(e){n(27);var t=o(n(18)),r=o(n(10));function o(e){return e&&e.__esModule?e:{default:e}}t.default.render(e.createElement(r.default,null),document.getElementById("app"))}).call(this,n(0))},22:function(e,t){},27:function(e,t){},5:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=window.innerWidth,o=function(t){function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.resizeable=!1,e.handleMouseMove=e.handleMouseMove.bind(e),e.state={width:400,tree:{},floatMenu:{show:!1,x:0,y:0}},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,e.Component),n(o,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmout",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"componentWillReceiveProps",value:function(e){var t=e.tree;this.setState({tree:this.resolveTree(t)})}},{key:"deep",value:function(e,t){!function e(n,r){return!1!==t(n,r)&&(!n.children||n.children.every(function(t){return e(t,n)}))}(e.root)}},{key:"findElement",value:function(e,t,n){e.stopPropagation();for(var r=e.target;!r.classList.contains(t);){if(r.classList.contains(n))return;r=r.parentElement}return r}},{key:"handleElementMouseUp",value:function(e){if(2!=e.button)return this.setState({floatMenu:{show:!1}});if(this.findElement(e,"element","element-tree")){var t=e.pageX,n=e.pageY;this.setState({floatMenu:{x:t,y:n,show:!0}})}}},{key:"handleElementClick",value:function(e){var t=this.findElement(e,"element","element-tree");if(t){var n=t.dataset.nid,r=this.dealNodeById(n,function(e){e&&(e.folded=!e.folded)});this.setState({tree:r})}}},{key:"dealNodeById",value:function(e,t){var n=this.state.tree;return this.deep(n,function(n){if(n.nid==e)return t(n),!1}),n}},{key:"resolveTree",value:function(e){var t=0;return this.deep(e,function(e,n){var r=e.children,o=r&&(r.length>=1||r[0].tag||hildren[0].text.length>20);e.folded=o,e.nid=t++;var i="";n?(i+=n.selector,i+=">",e.tag&&(i+=e.tag),e.id&&(i+="#",i+=e.id),e.class&&(i+=".",i+=e.class)):i="html",e.selector=i}),console.log(e),e}},{key:"completeTag",value:function(t){return e.createElement("div",{className:"tag-start"},"<",e.createElement("span",{className:"tag-name"},t.tag),["id","class","name","href","src"].map(function(n,r){return t[n]?e.createElement("span",{className:"tag-attribute",key:r}," ","id"==n?e.createElement("span",{className:"tag-key color-blue"},"id"):e.createElement("span",{className:"tag-key"},n),'="',e.createElement("span",{className:"tag-value"},t[n]),'"'):""}),">")}},{key:"handleRender",value:function(t){var n=this;return t.tag?e.createElement("div",{className:"element","data-nid":t.nid,key:t.nid},this.completeTag(t),t.children?t.folded?"...":t.children.map(function(e){return n.handleRender(e)}):"",e.createElement("div",{className:"tag-end"},"</",e.createElement("span",{className:"tag-name"},t.tag),">")):e.createElement("div",{className:"text",key:t.nid},t.text)}},{key:"renderTree",value:function(e){return e.root?this.handleRender(e.root):"加载中..."}},{key:"handleClick",value:function(){this.setState({floatMenu:{show:!1}})}},{key:"handleResize",value:function(){r=window.innerWidth}},{key:"handleMouseDown",value:function(){var e=this;window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",function t(){window.removeEventListener("mousemove",e.handleMouseMove),window.removeEventListener("mouseup",t)})}},{key:"handleMouseMove",value:function(e){var t=e.pageX;e.pageY;t>0&&this.setState({width:r-t})}},{key:"handleMouseUp",value:function(){this.resizeable=!0}},{key:"render",value:function(){var t=this.props.onTreeReload,n=this.handleMouseDown,r=this.handleElementClick,o=this.handleElementMouseUp,i=this.handleClick,a=this.state,l=a.width,s=a.tree,c=a.floatMenu,u=c.show,d=c.x,f=c.y;this.renderTree;return e.createElement("div",{className:"controls-wrapper"},e.createElement("div",{className:"resizeable",onMouseDown:n.bind(this)}),e.createElement("div",{className:"tool"},e.createElement("div",{className:"reload",onClick:t},"刷新")),e.createElement("div",{className:"controls",style:{width:l+"px"},onClick:i.bind(this)},e.createElement("div",{className:"float-menu"+(u?" show":""),style:{left:d+"px",top:f+"px"}}),e.createElement("div",{className:"content"},e.createElement("div",{className:"section"},e.createElement("div",{className:"header"},e.createElement("div",{className:"label"},"页面结构")),e.createElement("div",{className:"element-tree",onClick:r.bind(this),onMouseUp:o.bind(this)},this.renderTree(s))),e.createElement("div",{className:"label"}))))}}]),o}();t.default=o}).call(this,n(0))},8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="\n  .s_ipt {\n    background-color: #000000 !important;\n  }\n"},9:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=i(n(8));i(n(7));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(t){function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.reload=!1,e.handleDomReady=e.handleDomReady.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e.Component),r(n,[{key:"componentDidMount",value:function(){var e=this.refs.webview;e.addEventListener("did-finish-load",this.handleDomReady),e.addEventListener("console-message",function(e){console.log("Guest page logged a message:",e.message)})}},{key:"componentWillReceiveProps",value:function(e){e.reload!=this.reload&&webview.send("element-tree"),this.reload=e.reload}},{key:"componentWillUnmount",value:function(){this.refs.webview.removeEventListener("did-finish-load",this.handleDomReady)}},{key:"handleDomReady",value:function(){var e=this.refs.webview,t=this.props.onChange;e.insertCSS(o.default),e.executeJavaScript("\n      const ipcRenderer = nodeRequire('electron').ipcRenderer;\n      const html = document.querySelector('html')\n      const root = {\n        tag: html.tagName.toLowerCase()\n      }\n      const tree = { root }\n      function deep(currentElement, current) {\n        if (currentElement.childNodes.length <= 0 || (currentElement.childNodes.length == 1 && currentElement.childNodes[0].nodeName == '#comment')) return\n        current.children = [];\n        [].forEach.call(currentElement.childNodes, child => {\n          const _child = {}\n          if (!child.tagName) {\n            _child.text = child.textContent\n            current.children.push(_child)\n          } else {\n            _child.tag = child.tagName.toLowerCase()\n            if (child.src) _child.src = child.src\n            if (child.href) _child.href = child.href\n            if (child.classList.value) _child.class = child.classList.value\n            if (child.id) _child.id = child.id\n            if (child.name) _child.name = child.name\n            current.children.push(_child)\n            deep(child, _child)\n          }\n        })\n      }\n      ipcRenderer.on('element-tree', function() {\n        deep(html, root)\n        ipcRenderer.sendToHost({\n          type: 'element-tree',\n          data: tree\n        });\n      });\n      // ipcRenderer.on('cookie', function() {\n      //   ipcRenderer.sendToHost({\n      //     type: 'cookie',\n      //     data: document.cookie\n      //   });\n      // });\n    ",function(t){e.send("element-tree"),e.send("cookie")}),e.addEventListener("ipc-message",function(e){var n=e.channel,r=n.type,o=n.data;"element-tree"==r?t(o):"cookie"==r&&console.log(o)}),e.getWebContents().session.cookies.get({},function(e,t){console.log(t)})}},{key:"render",value:function(){var t=this.props.src;return e.createElement("webview",{ref:"webview",id:"webview",className:"webview",src:t,disablewebsecurity:"true",nodeintegration:"true",partition:"persist:juejin",preload:"file:///Users/tzc123/workspace/daz-spider/client/inject/preload.js"})}}]),n}();t.default=a}).call(this,n(0))}},[[20,0,1]]]);